<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Report - Shoprite Fleet Analysis (Updated)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            color: #333;
            line-height: 1.6;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 2rem 0;
            text-align: center;
            box-shadow: 0 4px 15px rgba(44, 62, 80, 0.2);
            position: relative;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            position: relative;
        }

        .nors-logo {
            position: absolute;
            top: 50%;
            right: 2rem;
            transform: translateY(-50%);
            opacity: 0.9;
        }

        .nors-logo img {
            height: 60px;
            width: auto;
            filter: brightness(0) invert(1); /* Makes logo white */
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            font-weight: 300;
            padding-right: 200px; /* Space for logo */
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
            padding-right: 200px; /* Space for logo */
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .navigation {
            background: white;
            padding: 1.5rem 2rem;
            margin-bottom: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 0.8rem;
            max-width: 1400px;
            margin-left: auto;
            margin-right: auto;
        }

        .nav-btn {
            background: #2c3e50;
            color: white;
            border: none;
            padding: 0.8rem 1.2rem;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 0.9rem;
            white-space: nowrap;
            min-width: fit-content;
            flex-shrink: 0;
        }

        .nav-btn:hover, .nav-btn.active {
            background: #34495e;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(44, 62, 80, 0.3);
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .card {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
        }

        .card-title {
            font-size: 0.9rem;
            color: #7f8c8d;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.5rem;
        }

        .card-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 0.5rem;
        }

        .card-description {
            font-size: 0.9rem;
            color: #95a5a6;
        }

        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .chart-container {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .chart-title {
            font-size: 1.3rem;
            color: #2c3e50;
            margin-bottom: 1.5rem;
            text-align: center;
            font-weight: 600;
        }

        .chart-wrapper {
            position: relative;
            height: 400px;
        }

        .data-table {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .table th,
        .table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #ecf0f1;
        }

        .table th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
            position: sticky;
            top: 0;
        }

        .table tr:hover {
            background-color: #f8f9fa;
        }

        .rank {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.8rem;
        }

        .critical {
            color: #e74c3c;
            font-weight: bold;
        }

        .warning {
            color: #f39c12;
            font-weight: bold;
        }

        .normal {
            color: #27ae60;
            font-weight: bold;
        }

        .text-content {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .text-content h2 {
            color: #2c3e50;
            margin-bottom: 1rem;
            border-bottom: 3px solid #2c3e50;
            padding-bottom: 0.5rem;
        }

        .text-content h3 {
            color: #34495e;
            margin: 1.5rem 0 1rem 0;
        }

        .text-content ul {
            margin-left: 2rem;
            margin-bottom: 1rem;
        }

        .text-content li {
            margin-bottom: 0.5rem;
        }

        .highlight-box {
            background: #f8f9fa;
            border-left: 4px solid #2c3e50;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }

        .model-analysis {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .model-card {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border-top: 4px solid #2c3e50;
        }

        .footer {
            text-align: center;
            padding: 2rem;
            color: #7f8c8d;
            border-top: 1px solid #ecf0f1;
            background: white;
            margin-top: 2rem;
            border-radius: 12px;
        }

        /* Large screens - Extra spacing for presentations */
        @media (min-width: 1600px) {
            .navigation {
                padding: 2rem 3rem;
                gap: 1.2rem;
                max-width: 1600px;
            }
            
            .nav-btn {
                padding: 1rem 1.8rem;
                font-size: 1rem;
            }
        }

        /* Ultra-wide screens */
        @media (min-width: 2000px) {
            .navigation {
                padding: 2.5rem 4rem;
                gap: 1.5rem;
                max-width: 1800px;
            }
            
            .nav-btn {
                padding: 1.2rem 2rem;
                font-size: 1.1rem;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            .header h1 {
                font-size: 2rem;
                padding-right: 0;
            }

            .header p {
                padding-right: 0;
            }

            .nors-logo img {
                position: static;
                transform: none;
                margin-top: 1rem;
                height: 40px;
            }
            
            .chart-grid {
                grid-template-columns: 1fr;
            }
            
            .chart-wrapper {
                height: 300px;
            }

            .navigation {
                flex-direction: column;
                gap: 0.5rem;
                padding: 1rem;
            }

            .nav-btn {
                width: 100%;
                text-align: center;
            }
        }

        @media (max-width: 1200px) and (min-width: 769px) {
            .navigation {
                gap: 0.5rem;
                padding: 1.2rem 1.5rem;
            }
            
            .nav-btn {
                padding: 0.7rem 1rem;
                font-size: 0.85rem;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div class="nors-logo">
                <img src="nors-logo.png" alt="NORS Logo" alt="NORS Logo">
            </div>
            <h1>Complete Report - Shoprite Fleet Analysis (Updated)</h1>
            <p>Period: February 2024 to June 2025 | 306 Interventions | 57 Vehicles | 1,251 Business Days</p>
        </div>
    </div>

    <div class="container">
        <!-- Navigation -->
        <div class="navigation">
            <button class="nav-btn active" onclick="showSection('overview')">Overview</button>
            <button class="nav-btn" onclick="showSection('vehicles')">Top 20 Vehicles</button>
            <button class="nav-btn" onclick="showSection('problems')">Problem Types</button>
            <button class="nav-btn" onclick="showSection('temporal')">Temporal Analysis</button>
            <button class="nav-btn" onclick="showSection('models')">Model Analysis</button>
            <button class="nav-btn" onclick="showSection('critical')">Critical Vehicles</button>
            <button class="nav-btn" onclick="showSection('conclusions')">Conclusions</button>
        </div>

        <!-- Overview Section -->
        <div id="overview" class="section active">
            <div class="summary-cards">
                <div class="card">
                    <div class="card-title">Total Vehicles</div>
                    <div class="card-value">57</div>
                    <div class="card-description">100% visited facilities</div>
                </div>
                <div class="card">
                    <div class="card-title">Total Interventions</div>
                    <div class="card-value">306</div>
                    <div class="card-description">Over 17 months of analysis</div>
                </div>
                <div class="card">
                    <div class="card-title">Fleet Availability</div>
                    <div class="card-value">95.3%</div>
                    <div class="card-description">Operational time achieved</div>
                </div>
                <div class="card">
                    <div class="card-title">Preventive Maintenance</div>
                    <div class="card-value">52%</div>
                    <div class="card-description">vs 48% corrective</div>
                </div>
            </div>

            <div class="chart-grid">
                <div class="chart-container">
                    <div class="chart-title">Distribution by Location</div>
                    <div class="chart-wrapper">
                        <canvas id="locationChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">Quarterly Evolution</div>
                    <div class="chart-wrapper">
                        <canvas id="quarterlyChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="text-content">
                <h2>Executive Summary</h2>
                <div class="highlight-box">
                    <strong>Critical Highlights:</strong>
                    <ul>
                        <li><strong>3 vehicles account for most critical cases:</strong> KEI0778 (73 business days), LDP8008 (62 business days), KEI0818 (58 business days)</li>
                        <li><strong>FMX 440 model represents 75% of critical vehicles</strong> in the Top 20</li>
                        <li><strong>Peak activity period:</strong> Q1 and Q2 of 2025 (80 and 84 interventions respectively)</li>
                        <li><strong>Most recurring problems:</strong> Maintenance/Diagnostic (54.6%), Electrical Systems (11.8%), Cooling Systems (7.8%)</li>
                        <li><strong>Time calculation:</strong> All times reflect business days only (excluding weekends and national holidays)</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Vehicles Section -->
        <div id="vehicles" class="section">
            <div class="chart-grid">
                <div class="chart-container">
                    <div class="chart-title">Top 10 - Most Critical Vehicles by Business Days</div>
                    <div class="chart-wrapper">
                        <canvas id="topVehiclesChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">Odometer Analysis - Top 20 Vehicles</div>
                    <div class="chart-wrapper">
                        <canvas id="odometerChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="data-table">
                <div class="chart-title">Top 20 - Complete Ranking by Business Days Immobilization</div>
                <table class="table">
                    <thead>
                        <tr>
                            <th>Pos</th>
                            <th>License Plate</th>
                            <th>Model</th>
                            <th>Visits</th>
                            <th>Business Days</th>
                            <th>Average Time</th>
                            <th>Odometer (km)</th>
                            <th>Last Visit</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="vehiclesTableBody">
                    </tbody>
                </table>
            </div>

            <div class="text-content">
                <h3>Distribution by Model in Top 20</h3>
                <ul>
                    <li><strong>FMX 440:</strong> 15 vehicles (75.0%) - 237 total visits</li>
                    <li><strong>FH 520:</strong> 4 vehicles (20.0%) - 63 total visits</li>
                    <li><strong>420:</strong> 1 vehicle (5.0%) - 3 total visits</li>
                </ul>
                
                <h3>Fleet Composition (57 vehicles total)</h3>
                <ul>
                    <li><strong>FMX 440:</strong> 44 vehicles (77.2%)</li>
                    <li><strong>FH 520:</strong> 10 vehicles (17.5%)</li>
                    <li><strong>420:</strong> 1 vehicle (1.8%)</li>
                    <li><strong>FL 240:</strong> 2 vehicles (3.5%)</li>
                </ul>

                <h3>Odometer Analysis - Key Insights</h3>
                <ul>
                    <li><strong>Highest mileage:</strong> KEI0818 (696,076 km) - Most critical maintenance needs</li>
                    <li><strong>Average fleet mileage:</strong> ~500,000 km across top 20 vehicles</li>
                    <li><strong>High-mileage pattern:</strong> Vehicles >600k km show increased maintenance frequency</li>
                    <li><strong>Business days calculation:</strong> All immobilization times exclude weekends and national holidays</li>
                </ul>
            </div>
        </div>

        <!-- Problems Section -->
        <div id="problems" class="section">
            <div class="chart-grid">
                <div class="chart-container">
                    <div class="chart-title">Most Common Intervention Types</div>
                    <div class="chart-wrapper">
                        <canvas id="interventionTypesChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">Average Business Days by Problem Type</div>
                    <div class="chart-wrapper">
                        <canvas id="problemsChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="data-table">
                <div class="chart-title">Complete Problem Breakdown by Technical Category</div>
                <table class="table">
                    <thead>
                        <tr>
                            <th>Technical Category</th>
                            <th>Interventions</th>
                            <th>% of Total</th>
                            <th>Total Business Days</th>
                            <th>Avg Days/Case</th>
                            <th>Priority Level</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Maintenance/Diagnostic</td>
                            <td class="normal">167</td>
                            <td class="normal">54.6%</td>
                            <td class="normal">487</td>
                            <td class="normal">2.9</td>
                            <td class="normal">Routine</td>
                        </tr>
                        <tr>
                            <td>Electrical System</td>
                            <td class="warning">36</td>
                            <td class="warning">11.8%</td>
                            <td class="warning">67</td>
                            <td class="warning">1.9</td>
                            <td class="warning">Medium</td>
                        </tr>
                        <tr>
                            <td>Cooling System</td>
                            <td class="warning">24</td>
                            <td class="warning">7.8%</td>
                            <td class="warning">145</td>
                            <td class="critical">6.0</td>
                            <td class="warning">Medium</td>
                        </tr>
                        <tr>
                            <td>Brake System</td>
                            <td class="warning">19</td>
                            <td class="warning">6.2%</td>
                            <td class="warning">46</td>
                            <td class="warning">2.4</td>
                            <td class="critical">High</td>
                        </tr>
                        <tr>
                            <td>Pneumatic/Air System</td>
                            <td class="normal">11</td>
                            <td class="normal">3.6%</td>
                            <td class="critical">223</td>
                            <td class="critical">20.3</td>
                            <td class="critical">High</td>
                        </tr>
                        <tr>
                            <td>Clutch</td>
                            <td class="normal">10</td>
                            <td class="normal">3.3%</td>
                            <td class="critical">113</td>
                            <td class="critical">11.3</td>
                            <td class="critical">High</td>
                        </tr>
                        <tr>
                            <td>Engine</td>
                            <td class="normal">8</td>
                            <td class="normal">2.6%</td>
                            <td class="critical">84</td>
                            <td class="critical">10.5</td>
                            <td class="critical">High</td>
                        </tr>
                        <tr>
                            <td>Suspension</td>
                            <td class="normal">8</td>
                            <td class="normal">2.6%</td>
                            <td class="normal">18</td>
                            <td class="normal">2.3</td>
                            <td class="warning">Medium</td>
                        </tr>
                        <tr>
                            <td>Transmission</td>
                            <td class="normal">8</td>
                            <td class="normal">2.6%</td>
                            <td class="warning">49</td>
                            <td class="warning">6.1</td>
                            <td class="critical">High</td>
                        </tr>
                        <tr>
                            <td>Chassis/Body</td>
                            <td class="normal">5</td>
                            <td class="normal">1.6%</td>
                            <td class="normal">8</td>
                            <td class="normal">1.6</td>
                            <td class="normal">Low</td>
                        </tr>
                        <tr>
                            <td>Fuel System</td>
                            <td class="normal">3</td>
                            <td class="normal">1.0%</td>
                            <td class="normal">10</td>
                            <td class="normal">3.3</td>
                            <td class="warning">Medium</td>
                        </tr>
                        <tr>
                            <td>Exhaust/Turbo</td>
                            <td class="normal">3</td>
                            <td class="normal">1.0%</td>
                            <td class="normal">6</td>
                            <td class="normal">2.0</td>
                            <td class="warning">Medium</td>
                        </tr>
                        <tr>
                            <td>Refrigeration System</td>
                            <td class="normal">2</td>
                            <td class="normal">0.7%</td>
                            <td class="normal">0</td>
                            <td class="normal">0.0</td>
                            <td class="normal">Low</td>
                        </tr>
                        <tr>
                            <td>Air Conditioning</td>
                            <td class="normal">2</td>
                            <td class="normal">0.7%</td>
                            <td class="normal">0</td>
                            <td class="normal">0.0</td>
                            <td class="normal">Low</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Temporal Section -->
        <div id="temporal" class="section">
            <div class="chart-grid">
                <div class="chart-container">
                    <div class="chart-title">Monthly Service Evolution</div>
                    <div class="chart-wrapper">
                        <canvas id="monthlyChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">Quarterly Analysis - Business Days</div>
                    <div class="chart-wrapper">
                        <canvas id="quarterlyDetailChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="data-table">
                <div class="chart-title">Cumulative Business Days - Quarterly Analysis</div>
                <table class="table">
                    <thead>
                        <tr>
                            <th>Quarter</th>
                            <th>No. of Visits</th>
                            <th>No. of Vehicles</th>
                            <th>Calendar Business Days</th>
                            <th>Cumulative Business Days*</th>
                            <th>% Utilization</th>
                            <th>Average Time</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Q1 2024 (Jan-Mar)</td>
                            <td>7</td>
                            <td>7</td>
                            <td>65</td>
                            <td>20</td>
                            <td class="normal">30.8%</td>
                            <td>2.9 days</td>
                        </tr>
                        <tr>
                            <td>Q2 2024 (Apr-Jun)</td>
                            <td>19</td>
                            <td>15</td>
                            <td>65</td>
                            <td>100</td>
                            <td class="normal">153.8%</td>
                            <td>5.3 days</td>
                        </tr>
                        <tr>
                            <td>Q3 2024 (Jul-Sep)</td>
                            <td class="warning">40</td>
                            <td>30</td>
                            <td>66</td>
                            <td class="critical">340</td>
                            <td class="critical">515.2%</td>
                            <td class="critical">8.5 days</td>
                        </tr>
                        <tr>
                            <td>Q4 2024 (Oct-Dec)</td>
                            <td class="critical">76</td>
                            <td>48</td>
                            <td>65</td>
                            <td>295</td>
                            <td class="critical">453.8%</td>
                            <td>3.9 days</td>
                        </tr>
                        <tr>
                            <td>Q1 2025 (Jan-Mar)</td>
                            <td class="critical">80</td>
                            <td>55</td>
                            <td>65</td>
                            <td>280</td>
                            <td class="critical">430.8%</td>
                            <td>3.5 days</td>
                        </tr>
                        <tr>
                            <td>Q2 2025 (Apr-Jun)</td>
                            <td class="critical">84</td>
                            <td>47</td>
                            <td>65</td>
                            <td>216</td>
                            <td class="critical">332.3%</td>
                            <td>3.0 days</td>
                        </tr>
                    </tbody>
                </table>
                <div style="margin-top: 1rem; padding: 1rem; background-color: #f8f9fa; border-radius: 8px; font-size: 0.9rem; color: #6c757d;">
                    <strong>* Cumulative Business Days:</strong> Total sum of all individual vehicle immobilization periods during the quarter (business days only - excluding weekends and national holidays). 
                    <br><strong>% Utilization:</strong> Calculated as (Cumulative Business Days ÷ Calendar Business Days) × 100. Values above 100% indicate multiple vehicles being serviced simultaneously.
                    <br><strong>Example:</strong> Q3 2024 shows 340 cumulative days from 40 interventions across 30 vehicles, representing the total workshop capacity utilized.
                </div>
            </div>
        </div>

        <!-- Models Section -->
        <div id="models" class="section">
            <div class="chart-container">
                <div class="chart-title">Vehicle Distribution by Model</div>
                <div class="chart-wrapper">
                    <canvas id="modelsChart"></canvas>
                </div>
            </div>

            <div class="model-analysis">
                <div class="model-card">
                    <h3>FMX 440</h3>
                    <ul>
                        <li><strong>Fleet quantity:</strong> 44 vehicles</li>
                        <li><strong>Visited facilities:</strong> 44 (100%)</li>
                        <li><strong>Total interventions:</strong> 237</li>
                        <li><strong>Average visits:</strong> 5.4 per vehicle</li>
                        <li><strong>Average time:</strong> 4.4 business days</li>
                        <li><strong>Most frequent problems:</strong> Maintenance/Diagnostic, Electrical issues</li>
                    </ul>
                </div>

                <div class="model-card">
                    <h3>FH 520</h3>
                    <ul>
                        <li><strong>Fleet quantity:</strong> 10 vehicles</li>
                        <li><strong>Visited facilities:</strong> 10 (100%)</li>
                        <li><strong>Total interventions:</strong> 63</li>
                        <li><strong>Average visits:</strong> 6.3 per vehicle</li>
                        <li><strong>Average time:</strong> 3.4 business days</li>
                        <li><strong>Most frequent problems:</strong> Cooling system, Clutch issues</li>
                    </ul>
                </div>

                <div class="model-card">
                    <h3>420</h3>
                    <ul>
                        <li><strong>Fleet quantity:</strong> 1 vehicle</li>
                        <li><strong>Visited facilities:</strong> 1 (100%)</li>
                        <li><strong>Total interventions:</strong> 3</li>
                        <li><strong>Average visits:</strong> 3.0 per vehicle</li>
                        <li><strong>Average time:</strong> 20.7 business days</li>
                        <li><strong>Most frequent problems:</strong> Engine failures</li>
                    </ul>
                </div>

                <div class="model-card">
                    <h3>FL 240</h3>
                    <ul>
                        <li><strong>Fleet quantity:</strong> 2 vehicles</li>
                        <li><strong>Visited facilities:</strong> 2 (100%)</li>
                        <li><strong>Total interventions:</strong> 2</li>
                        <li><strong>Average visits:</strong> 1.0 per vehicle</li>
                        <li><strong>Average time:</strong> 0.0 business days</li>
                        <li><strong>Most frequent problems:</strong> Preventive maintenance only</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Critical Vehicles Section -->
        <div id="critical" class="section">
            <div class="text-content">
                <h2>Detailed Analysis of Critical Vehicles (Business Days)</h2>
                <p><strong>Criteria:</strong> More than 8 visits or more than 40 business days of immobilization</p>

                <div class="highlight-box">
                    <h3>KEI0778 - FMX 440 (Most Critical)</h3>
                    <ul>
                        <li><strong>Total visits:</strong> 10</li>
                        <li><strong>Total business days immobilized:</strong> 73</li>
                        <li><strong>Maximum time in one intervention:</strong> 26 business days (solenoid valve replacement)</li>
                        <li><strong>Recurring problems:</strong> Clutch failure, pneumatic circuit anomalies</li>
                        <li><strong>Last major intervention:</strong> Complete clutch replacement - 7 business days (Mar 2025)</li>
                        <li><strong>Average per visit:</strong> 7.3 business days</li>
                        <li><strong>⚠️ Extended delay reason:</strong> Solenoid valve shortage in national stock; imported part with customs delay</li>
                    </ul>
                </div>

                <div class="highlight-box">
                    <h3>LDP8008 - 420 (Second Most Critical)</h3>
                    <ul>
                        <li><strong>Total visits:</strong> 3</li>
                        <li><strong>Total business days immobilized:</strong> 62</li>
                        <li><strong>Maximum time in one intervention:</strong> 49 business days (engine malfunction)</li>
                        <li><strong>Recurring problems:</strong> Engine failure, power loss</li>
                        <li><strong>Last major intervention:</strong> Basic revision + water pump replacement - 9 business days (Feb 2025)</li>
                        <li><strong>Average per visit:</strong> 20.7 business days</li>
                        <li><strong>⚠️ Extended delay reason:</strong> Budget approval process + engine component importation required</li>
                    </ul>
                </div>

                <div class="highlight-box">
                    <h3>KEI0818 - FH 520 (Third Most Critical)</h3>
                    <ul>
                        <li><strong>Total visits:</strong> 10</li>
                        <li><strong>Total business days immobilized:</strong> 58</li>
                        <li><strong>Maximum time in one intervention:</strong> 15 business days (cooling system repair)</li>
                        <li><strong>Recurring problems:</strong> Clutch, overheating issues</li>
                        <li><strong>Last major intervention:</strong> Complete inspection & radiator replacement - 7 business days (Apr 2025)</li>
                        <li><strong>Average per visit:</strong> 5.8 business days</li>
                        <li><strong>High mileage factor:</strong> 696,076 km - highest in fleet</li>
                    </ul>
                </div>

                <div class="highlight-box">
                    <h3>KEI0817 - FH 520</h3>
                    <ul>
                        <li><strong>Total visits:</strong> 5</li>
                        <li><strong>Total business days immobilized:</strong> 57</li>
                        <li><strong>Maximum time in one intervention:</strong> 49 business days (engine analysis)</li>
                        <li><strong>Recurring problems:</strong> Engine performance issues</li>
                        <li><strong>Average per visit:</strong> 11.4 business days</li>
                        <li><strong>⚠️ Extended delay reason:</strong> Awaiting manufacturer analysis for warranty claim on engine failure</li>
                    </ul>
                </div>

                <h3>Root Cause Analysis - Business Days Impact</h3>
                <div class="highlight-box">
                    <h4>Primary Delay Categories</h4>
                    <ul>
                        <li><strong>Parts Import Delays (60%):</strong> KEI0898, KEI0778, KEI0892 - Specialized components requiring international sourcing</li>
                        <li><strong>Approval Processes (20%):</strong> LDP8008 - Budget approval for major engine work</li>
                        <li><strong>Warranty Procedures (20%):</strong> KEI0817 - Manufacturer analysis for warranty claims</li>
                    </ul>
                    <p><em>These factors explain over 80% of extended immobilization periods for critical vehicles, calculated in business days only.</em></p>
                </div>

                <h3>Critical Systems Analysis</h3>
                <div class="highlight-box">
                    <h4>Highest Impact Systems (Business Days)</h4>
                    <ul>
                        <li><strong>Pneumatic/Air System:</strong> 223 business days total (20.3 avg/case) - Most impactful</li>
                        <li><strong>Cooling System:</strong> 145 business days total (6.0 avg/case) - High frequency + impact</li>
                        <li><strong>Clutch System:</strong> 113 business days total (11.3 avg/case) - Critical component</li>
                        <li><strong>Engine Issues:</strong> 84 business days total (10.5 avg/case) - Major repairs</li>
                    </ul>
                </div>
            </div>

            <div class="data-table">
                <div class="chart-title">Critical Cases - Detailed Breakdown (Business Days)</div>
                <h3>KEI0778 - FMX 440 (Top Priority)</h3>
                <table class="table">
                    <thead>
                        <tr>
                            <th>Entry Date</th>
                            <th>Exit Date</th>
                            <th>Business Days</th>
                            <th>Type of Intervention</th>
                            <th>Notes</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>03/04/2024</td>
                            <td>09/05/2024</td>
                            <td class="critical">26</td>
                            <td>Replace solenoid valve</td>
                            <td>Import delays + customs</td>
                        </tr>
                        <tr>
                            <td>30/08/2024</td>
                            <td>20/09/2024</td>
                            <td class="warning">15</td>
                            <td>Replace APM</td>
                            <td>Customs clearance delay</td>
                        </tr>
                        <tr>
                            <td>05/03/2025</td>
                            <td>14/03/2025</td>
                            <td class="normal">7</td>
                            <td>Replace clutch</td>
                            <td>Complete kit shortage</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Conclusions Section -->
        <div id="conclusions" class="section">
            <div class="text-content">
                <h2>Consolidated Summary - Global Fleet Analysis (Business Days)</h2>
                
                <h3>General Fleet Statistics</h3>
                <ul>
                    <li><strong>Total vehicles in fleet:</strong> 57</li>
                    <li><strong>Vehicles that visited facilities:</strong> 57 (100%)</li>
                    <li><strong>Total business days immobilization:</strong> 1,251 days</li>
                    <li><strong>Average business days per intervention:</strong> 4.3 days</li>
                    <li><strong>Range:</strong> 1 to 73 business days per intervention</li>
                </ul>

                <h3>Service Type Distribution</h3>
                <ul>
                    <li><strong>Basic Revision:</strong> 114 cases (37.3%)</li>
                    <li><strong>Complete Revision:</strong> 36 cases (11.8%)</li>
                    <li><strong>Battery Replacement:</strong> 18 cases (5.9%)</li>
                    <li><strong>Diagnostics:</strong> 7 cases (2.3%)</li>
                    <li><strong>Other specific repairs:</strong> 131 cases (42.8%)</li>
                </ul>

                <h3>Quarterly Performance Trends (Business Days)</h3>
                <ul>
                    <li><strong>Q3 2024:</strong> Highest average (8.5 business days) - Peak of complex issues</li>
                    <li><strong>Q2 2025:</strong> Best performance (3.0 business days) - Improved efficiency</li>
                    <li><strong>Overall trend:</strong> Decreasing average time from Q3 2024 onwards</li>
                    <li><strong>Volume increase:</strong> 2025 shows significant activity increase vs 2024</li>
                </ul>

                <h3>Critical Performance Indicators</h3>
                <ul>
                    <li><strong>Top 3 vehicles account for:</strong> 193 business days (15.4% of total)</li>
                    <li><strong>Business days calculation excludes:</strong> Weekends, national holidays, bridge days</li>
                    <li><strong>Most efficient quarter:</strong> Q2 2025 (3.0 avg days)</li>
                    <li><strong>Most challenging quarter:</strong> Q3 2024 (8.5 avg days)</li>
                </ul>

                <div class="highlight-box">
                    <h3>Technical Context - Business Days Methodology</h3>
                    <h4>Calculation Method</h4>
                    <ul>
                        <li><strong>Business days definition:</strong> Monday to Friday only</li>
                        <li><strong>Excluded days:</strong> Saturdays, Sundays, national holidays, bridge days</li>
                        <li><strong>National holidays considered:</strong> New Year, February 4th, March 8th, March 23rd, Good Friday, Peace Day (April 4th), Labor Day (May 1st), Hero's Day (September 17th), Independence Day (November 11th), Christmas Day</li>
                        <li><strong>Impact of correction:</strong> Reduced from calendar days to 1,251 business days (-14 days from weekend/holiday exclusion)</li>
                        <li><strong>Real operational impact:</strong> Business days better reflect actual workshop productivity and resource utilization</li>
                    </ul>

                    <h4>Key Insights from Business Days Analysis</h4>
                    <ul>
                        <li><strong>More accurate efficiency measurement:</strong> Excludes non-productive days</li>
                        <li><strong>Better resource planning:</strong> Shows true workshop utilization</li>
                        <li><strong>Improved benchmarking:</strong> Comparable metrics across different periods</li>
                        <li><strong>Enhanced decision-making:</strong> Focuses on controllable factors</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="footer">
        <p><strong>NORS Trucks and Buses Angola VT</strong></p>
        <p>Business Support | Email: simaia@nors.com</p>
        <p>Data based on Shoprite control and registration dashboard</p>
        <p style="font-size: 0.8rem; margin-top: 1rem; opacity: 0.7;">© 2025 NORS Angola. All rights reserved. | Business days calculation excludes weekends and national holidays</p>
    </div>

    <script>
        // Navigation function
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionId).classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');
        }

        // Updated data with business days (excluding weekends and holidays)
        const topVehiclesData = [
            {plate: 'KEI0778', model: 'FMX 440', visits: 10, days: 73, avgDays: 7.3, lastVisit: 'Mar 2025', odometer: 518470},
            {plate: 'LDP8008', model: '420', visits: 3, days: 62, avgDays: 20.7, lastVisit: 'Feb 2025', odometer: 641108},
            {plate: 'KEI0818', model: 'FH 520', visits: 10, days: 58, avgDays: 5.8, lastVisit: 'Apr 2025', odometer: 696076},
            {plate: 'KEI0817', model: 'FH 520', visits: 5, days: 57, avgDays: 11.4, lastVisit: 'Jun 2025', odometer: 577119},
            {plate: 'KEI0744', model: 'FMX 440', visits: 6, days: 48, avgDays: 8.0, lastVisit: 'Mar 2025', odometer: 494791},
            {plate: 'KEI0898', model: 'FMX 440', visits: 6, days: 47, avgDays: 7.8, lastVisit: 'May 2025', odometer: 350647},
            {plate: 'KEI0809', model: 'FMX 440', visits: 9, days: 47, avgDays: 5.2, lastVisit: 'May 2025', odometer: 580398},
            {plate: 'KEI0899', model: 'FMX 440', visits: 7, days: 45, avgDays: 6.4, lastVisit: 'Jun 2025', odometer: 524737},
            {plate: 'KEI0911', model: 'FMX 440', visits: 6, days: 39, avgDays: 6.5, lastVisit: 'May 2025', odometer: 401584},
            {plate: 'LD9338HL', model: 'FMX 440', visits: 4, days: 36, avgDays: 9.0, lastVisit: 'May 2025', odometer: 386030},
            {plate: 'KEI0841', model: 'FMX 440', visits: 5, days: 33, avgDays: 6.6, lastVisit: 'Jun 2025', odometer: 528025},
            {plate: 'KEI0751', model: 'FMX 440', visits: 7, days: 32, avgDays: 4.6, lastVisit: 'Jun 2025', odometer: 566596},
            {plate: 'KEI0879', model: 'FMX 440', visits: 8, days: 32, avgDays: 4.0, lastVisit: 'May 2025', odometer: 507759},
            {plate: 'KEI0906', model: 'FMX 440', visits: 3, days: 30, avgDays: 10.0, lastVisit: 'Dec 2024', odometer: 243791},
            {plate: 'KEI0922', model: 'FMX 440', visits: 6, days: 30, avgDays: 5.0, lastVisit: 'Apr 2025', odometer: 376987},
            {plate: 'KEI0777', model: 'FMX 440', visits: 9, days: 30, avgDays: 3.3, lastVisit: 'May 2025', odometer: 468494},
            {plate: 'KEI0755', model: 'FMX 440', visits: 8, days: 28, avgDays: 3.5, lastVisit: 'Jun 2025', odometer: 610898},
            {plate: 'KEI0901', model: 'FMX 440', visits: 7, days: 27, avgDays: 3.9, lastVisit: 'May 2025', odometer: 428300},
            {plate: 'KEI0923', model: 'FMX 440', visits: 6, days: 26, avgDays: 4.3, lastVisit: 'Jun 2025', odometer: 388775},
            {plate: 'KEI0775', model: 'FMX 440', visits: 7, days: 26, avgDays: 3.7, lastVisit: 'Jun 2025', odometer: 468178}
        ];

        // Updated quarterly data (business days)
        const quarterlyData = {
            visits: [7, 19, 40, 76, 80, 84],
            avgDays: [2.9, 5.3, 8.5, 3.9, 3.5, 3.0]
        };

        // Top Vehicles Chart (Updated with business days)
        const topVehiclesChart = new Chart(document.getElementById('topVehiclesChart'), {
            type: 'bar',
            data: {
                labels: topVehiclesData.slice(0, 10).map(v => v.plate),
                datasets: [{
                    label: 'Business Days Immobilized',
                    data: topVehiclesData.slice(0, 10).map(v => v.days),
                    backgroundColor: topVehiclesData.slice(0, 10).map((v, i) => {
                        if (v.days >= 60) return '#e74c3c'; // Critical: 60+ business days
                        if (v.days >= 45) return '#f39c12'; // High: 45-59 business days  
                        if (v.days >= 30) return '#3498db'; // Medium: 30-44 business days
                        return '#27ae60'; // Lower: <30 business days
                    }),
                    borderRadius: 8,
                    borderSkipped: false,
                    maxBarThickness: 50
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                animation: {
                    duration: 1800,
                    easing: 'easeInOutQuart',
                    delay: (context) => context.dataIndex * 120
                },
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        backgroundColor: 'rgba(44, 62, 80, 0.9)',
                        titleColor: '#fff',
                        bodyColor: '#fff',
                        borderColor: '#2c3e50',
                        borderWidth: 2,
                        cornerRadius: 8,
                        callbacks: {
                            title: function(context) {
                                return `Vehicle: ${context[0].label}`;
                            },
                            label: function(context) {
                                return `Business Days: ${context.parsed.y}`;
                            },
                            afterLabel: function(context) {
                                const vehicle = topVehiclesData[context.dataIndex];
                                return [
                                    `Model: ${vehicle.model}`,
                                    `Total visits: ${vehicle.visits}`,
                                    `Average per visit: ${vehicle.avgDays} business days`,
                                    `Odometer: ${vehicle.odometer.toLocaleString()} km`,
                                    `(Excluding weekends & holidays)`
                                ];
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 80,
                        title: {
                            display: true,
                            text: 'Business Days Immobilized',
                            font: {
                                size: 14,
                                weight: '600'
                            }
                        },
                        ticks: {
                            stepSize: 10,
                            font: {
                                size: 11,
                                weight: '500'
                            }
                        },
                        grid: {
                            color: 'rgba(44, 62, 80, 0.1)',
                            lineWidth: 1
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Vehicle License Plate',
                            font: {
                                size: 14,
                                weight: '600'
                            }
                        },
                        grid: {
                            display: false
                        },
                        ticks: {
                            font: {
                                size: 11,
                                weight: '500'
                            },
                            maxRotation: 45
                        }
                    }
                }
            }
        });

        // Odometer Chart (Enhanced Horizontal Bar)
        const odometerChart = new Chart(document.getElementById('odometerChart'), {
            type: 'bar',
            data: {
                labels: topVehiclesData.slice(0, 15).map(v => v.plate),
                datasets: [{
                    label: 'Odometer (km)',
                    data: topVehiclesData.slice(0, 15).map(v => v.odometer),
                    backgroundColor: topVehiclesData.slice(0, 15).map((v, i) => {
                        if (v.odometer > 600000) return '#e74c3c'; // Very high mileage
                        if (v.odometer > 500000) return '#f39c12'; // High mileage
                        if (v.odometer > 400000) return '#3498db'; // Medium mileage
                        return '#27ae60'; // Lower mileage
                    }),
                    borderRadius: 6,
                    borderSkipped: false,
                    maxBarThickness: 30
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                indexAxis: 'y',
                animation: {
                    duration: 1800,
                    easing: 'easeInOutQuart',
                    delay: (context) => context.dataIndex * 100
                },
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        backgroundColor: 'rgba(44, 62, 80, 0.9)',
                        titleColor: '#fff',
                        bodyColor: '#fff',
                        borderColor: '#2c3e50',
                        borderWidth: 2,
                        cornerRadius: 8,
                        callbacks: {
                            title: function(context) {
                                return `Vehicle: ${context[0].label}`;
                            },
                            label: function(context) {
                                return `Odometer: ${context.parsed.x.toLocaleString()} km`;
                            },
                            afterLabel: function(context) {
                                const vehicle = topVehiclesData[context.dataIndex];
                                const ageCategory = vehicle.odometer > 600000 ? 'Very High Mileage' :
                                                  vehicle.odometer > 500000 ? 'High Mileage' :
                                                  vehicle.odometer > 400000 ? 'Medium Mileage' : 'Lower Mileage';
                                return [
                                    `Model: ${vehicle.model}`,
                                    `Business days immobilized: ${vehicle.days}`,
                                    `Visits: ${vehicle.visits}`,
                                    `Category: ${ageCategory}`
                                ];
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        beginAtZero: true,
                        max: 750000,
                        title: {
                            display: true,
                            text: 'Odometer Reading (km)',
                            font: {
                                size: 14,
                                weight: '600'
                            }
                        },
                        ticks: {
                            stepSize: 100000,
                            font: {
                                size: 11,
                                weight: '500'
                            },
                            callback: function(value) {
                                return (value / 1000) + 'k';
                            }
                        },
                        grid: {
                            color: 'rgba(44, 62, 80, 0.1)',
                            lineWidth: 1
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'Vehicle License Plate',
                            font: {
                                size: 14,
                                weight: '600'
                            }
                        },
                        grid: {
                            display: false
                        },
                        ticks: {
                            font: {
                                size: 10,
                                weight: '500'
                            }
                        }
                    }
                }
            }
        });

        // Location Distribution Chart
        const locationChart = new Chart(document.getElementById('locationChart'), {
            type: 'doughnut',
            data: {
                labels: ['Icolo e Bengo', 'Lobito', 'Lubango'],
                datasets: [{
                    data: [63.1, 35.6, 1.3],
                    backgroundColor: ['#2c3e50', '#3498db', '#e74c3c'],
                    borderWidth: 0,
                    cutout: '60%'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                animation: {
                    animateRotate: true,
                    animateScale: true,
                    duration: 1500,
                    easing: 'easeInOutQuart'
                },
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            padding: 20,
                            usePointStyle: true
                        }
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return context.label + ': ' + context.parsed + '%';
                            }
                        }
                    }
                }
            }
        });

        // Quarterly Evolution Chart
        const quarterlyChart = new Chart(document.getElementById('quarterlyChart'), {
            type: 'line',
            data: {
                labels: ['Q1 2024', 'Q2 2024', 'Q3 2024', 'Q4 2024', 'Q1 2025', 'Q2 2025'],
                datasets: [{
                    label: 'Number of Visits',
                    data: quarterlyData.visits,
                    borderColor: '#2c3e50',
                    backgroundColor: 'rgba(44, 62, 80, 0.1)',
                    tension: 0.4,
                    fill: true,
                    pointRadius: 6,
                    pointHoverRadius: 8,
                    pointBackgroundColor: '#2c3e50',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                animation: {
                    duration: 2000,
                    easing: 'easeInOutQuart'
                },
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Number of Interventions'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Quarter'
                        }
                    }
                }
            }
        });

        // Intervention Types Chart (Updated with business days data)
        const interventionTypesChart = new Chart(document.getElementById('interventionTypesChart'), {
            type: 'pie',
            data: {
                labels: ['Maintenance/Diagnostic', 'Electrical System', 'Cooling System', 'Brake System', 'Pneumatic System', 'Clutch', 'Engine', 'Others'],
                datasets: [{
                    data: [54.6, 11.8, 7.8, 6.2, 3.6, 3.3, 2.6, 10.1],
                    backgroundColor: ['#2c3e50', '#3498db', '#1abc9c', '#f39c12', '#e67e22', '#e74c3c', '#9b59b6', '#95a5a6'],
                    borderWidth: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                animation: {
                    duration: 1800,
                    easing: 'easeInOutQuart'
                },
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            padding: 15,
                            usePointStyle: true,
                            font: {
                                size: 12,
                                weight: '500'
                            }
                        }
                    },
                    tooltip: {
                        backgroundColor: 'rgba(44, 62, 80, 0.9)',
                        titleColor: '#fff',
                        bodyColor: '#fff',
                        borderColor: '#2c3e50',
                        borderWidth: 2,
                        cornerRadius: 8,
                        callbacks: {
                            label: function(context) {
                                return `${context.label}: ${context.parsed}%`;
                            },
                            afterLabel: function(context) {
                                const interventionCounts = [167, 36, 24, 19, 11, 10, 8, 31];
                                return `Interventions: ~${interventionCounts[context.dataIndex]}`;
                            }
                        }
                    }
                }
            }
        });

        // Problems Chart (Updated with business days averages)
        const problemsChart = new Chart(document.getElementById('problemsChart'), {
            type: 'bar',
            data: {
                labels: ['Pneumatic/Air', 'Clutch', 'Engine', 'Cooling', 'Transmission', 'Maintenance'],
                datasets: [{
                    label: 'Average Business Days',
                    data: [20.3, 11.3, 10.5, 6.0, 6.1, 2.9],
                    backgroundColor: ['#e74c3c', '#f39c12', '#e67e22', '#3498db', '#9b59b6', '#27ae60'],
                    borderRadius: 8,
                    borderSkipped: false,
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                indexAxis: 'y',
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        backgroundColor: 'rgba(44, 62, 80, 0.9)',
                        titleColor: '#fff',
                        bodyColor: '#fff',
                        borderColor: '#2c3e50',
                        borderWidth: 2,
                        cornerRadius: 8,
                        callbacks: {
                            title: function(context) {
                                return `${context[0].label} System`;
                            },
                            label: function(context) {
                                return `Average: ${context.parsed.x} business days`;
                            },
                            afterLabel: function(context) {
                                const totalDays = [223, 113, 84, 145, 49, 487];
                                const interventions = [11, 10, 8, 24, 8, 167];
                                return [
                                    `Total business days: ${totalDays[context.dataIndex]}`,
                                    `Number of cases: ${interventions[context.dataIndex]}`
                                ];
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Average Business Days per Case'
                        }
                    }
                }
            }
        });

        // Monthly Chart (Enhanced with business days context)
        const monthlyChart = new Chart(document.getElementById('monthlyChart'), {
            type: 'bar',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                datasets: [{
                    label: '2024',
                    data: [0, 5, 2, 8, 9, 2, 7, 8, 25, 26, 24, 26],
                    backgroundColor: '#2c3e50',
                    borderRadius: 6,
                    borderSkipped: false,
                    maxBarThickness: 40
                }, {
                    label: '2025',
                    data: [23, 33, 24, 17, 35, 32, 0, 0, 0, 0, 0, 0],
                    backgroundColor: '#27ae60',
                    borderRadius: 6,
                    borderSkipped: false,
                    maxBarThickness: 40
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                animation: {
                    duration: 1800,
                    easing: 'easeInOutQuart',
                    delay: (context) => context.dataIndex * 100
                },
                plugins: {
                    legend: {
                        position: 'top',
                        labels: {
                            padding: 20,
                            usePointStyle: true,
                            font: {
                                size: 14,
                                weight: '600'
                            }
                        }
                    },
                    tooltip: {
                        backgroundColor: 'rgba(44, 62, 80, 0.9)',
                        titleColor: '#fff',
                        bodyColor: '#fff',
                        borderColor: '#2c3e50',
                        borderWidth: 2,
                        cornerRadius: 8,
                        callbacks: {
                            title: function(context) {
                                return `${context[0].label} ${context[0].dataset.label}`;
                            },
                            label: function(context) {
                                return `Interventions: ${context.parsed.y}`;
                            },
                            afterBody: function(context) {
                                const value = context[0].parsed.y;
                                if (value === 0) return ['', 'No data available'];
                                return ['', `Business days calculation applies to all periods`];
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'Month',
                            font: {
                                size: 14,
                                weight: '600'
                            }
                        },
                        grid: {
                            display: false
                        },
                        ticks: {
                            font: {
                                size: 12,
                                weight: '500'
                            }
                        }
                    },
                    y: {
                        beginAtZero: true,
                        max: 40,
                        title: {
                            display: true,
                            text: 'Number of Interventions',
                            font: {
                                size: 14,
                                weight: '600'
                            }
                        },
                        ticks: {
                            stepSize: 5,
                            font: {
                                size: 11,
                                weight: '500'
                            }
                        },
                        grid: {
                            color: 'rgba(44, 62, 80, 0.1)',
                            lineWidth: 1
                        }
                    }
                }
            }
        });

        // Quarterly Detail Chart (Enhanced with business days)
        const quarterlyDetailChart = new Chart(document.getElementById('quarterlyDetailChart'), {
            type: 'bar',
            data: {
                labels: ['Q1 2024', 'Q2 2024', 'Q3 2024', 'Q4 2024', 'Q1 2025', 'Q2 2025'],
                datasets: [{
                    label: 'Number of Visits',
                    data: quarterlyData.visits,
                    backgroundColor: '#2c3e50',
                    borderRadius: 8,
                    borderSkipped: false,
                    yAxisID: 'y',
                    maxBarThickness: 60
                }, {
                    label: 'Average Business Days',
                    data: quarterlyData.avgDays,
                    borderColor: '#e74c3c',
                    backgroundColor: '#e74c3c',
                    type: 'line',
                    yAxisID: 'y1',
                    tension: 0.4,
                    pointRadius: 8,
                    pointHoverRadius: 10,
                    pointBackgroundColor: '#e74c3c',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 3,
                    borderWidth: 4,
                    fill: false
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                animation: {
                    duration: 2000,
                    easing: 'easeInOutQuart'
                },
                plugins: {
                    legend: {
                        position: 'top',
                        labels: {
                            padding: 20,
                            usePointStyle: true,
                            font: {
                                size: 14,
                                weight: '600'
                            }
                        }
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false,
                        backgroundColor: 'rgba(44, 62, 80, 0.9)',
                        titleColor: '#fff',
                        bodyColor: '#fff',
                        borderColor: '#2c3e50',
                        borderWidth: 2,
                        cornerRadius: 8,
                        callbacks: {
                            title: function(context) {
                                return context[0].label;
                            },
                            label: function(context) {
                                if (context.datasetIndex === 0) {
                                    return `Visits: ${context.parsed.y}`;
                                } else {
                                    return `Avg Business Days: ${context.parsed.y}`;
                                }
                            },
                            afterBody: function(context) {
                                const quarter = context[0].label;
                                const visits = context[0].parsed.y;
                                const avgTime = context[1] ? context[1].parsed.y : 0;
                                const totalDays = Math.round(visits * avgTime);
                                return [``, `Total Impact: ${totalDays} business days`, `(Excluding weekends & holidays)`];
                            }
                        }
                    }
                },
                interaction: {
                    mode: 'index',
                    intersect: false,
                },
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'Quarter',
                            font: {
                                size: 14,
                                weight: '600'
                            }
                        },
                        grid: {
                            display: false
                        },
                        ticks: {
                            font: {
                                size: 12,
                                weight: '500'
                            }
                        }
                    },
                    y: {
                        type: 'linear',
                        display: true,
                        position: 'left',
                        beginAtZero: true,
                        max: 90,
                        title: {
                            display: true,
                            text: 'Number of Visits',
                            color: '#2c3e50',
                            font: {
                                size: 14,
                                weight: '600'
                            }
                        },
                        ticks: {
                            stepSize: 10,
                            color: '#2c3e50',
                            font: {
                                size: 11,
                                weight: '500'
                            }
                        },
                        grid: {
                            color: 'rgba(44, 62, 80, 0.1)',
                            lineWidth: 1
                        }
                    },
                    y1: {
                        type: 'linear',
                        display: true,
                        position: 'right',
                        beginAtZero: true,
                        max: 10,
                        title: {
                            display: true,
                            text: 'Average Business Days',
                            color: '#e74c3c',
                            font: {
                                size: 14,
                                weight: '600'
                            }
                        },
                        ticks: {
                            stepSize: 1,
                            color: '#e74c3c',
                            font: {
                                size: 11,
                                weight: '500'
                            }
                        },
                        grid: {
                            drawOnChartArea: false,
                            color: 'rgba(231, 76, 60, 0.1)'
                        }
                    }
                }
            }
        });

        // Models Chart (Enhanced with corrected fleet data)
        const modelsChart = new Chart(document.getElementById('modelsChart'), {
            type: 'doughnut',
            data: {
                labels: ['FMX 440', 'FH 520', 'FL 240', '420'],
                datasets: [{
                    data: [44, 10, 2, 1], // Corrected: 44+10+2+1 = 57 vehicles
                    backgroundColor: ['#2c3e50', '#3498db', '#f39c12', '#e74c3c'],
                    borderWidth: 3,
                    borderColor: '#fff',
                    cutout: '55%',
                    hoverOffset: 15
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                animation: {
                    animateRotate: true,
                    animateScale: true,
                    duration: 2000,
                    easing: 'easeInOutBack',
                    delay: (context) => {
                        let delay = 0;
                        if (context.type === 'data' && context.mode === 'default') {
                            delay = context.dataIndex * 300;
                        }
                        return delay;
                    }
                },
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            padding: 25,
                            usePointStyle: true,
                            pointStyle: 'circle',
                            font: {
                                size: 13,
                                weight: '600'
                            }
                        }
                    },
                    tooltip: {
                        backgroundColor: 'rgba(44, 62, 80, 0.9)',
                        titleColor: '#fff',
                        bodyColor: '#fff',
                        borderColor: '#2c3e50',
                        borderWidth: 2,
                        cornerRadius: 8,
                        callbacks: {
                            title: function(context) {
                                return `Model: ${context[0].label}`;
                            },
                            label: function(context) {
                                const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                const percentage = ((context.parsed / total) * 100).toFixed(1);
                                return `Vehicles: ${context.parsed} (${percentage}%)`;
                            },
                            afterLabel: function(context) {
                                const interventionsData = [237, 63, 2, 3];
                                const avgVisits = (interventionsData[context.dataIndex] / context.parsed).toFixed(1);
                                return [
                                    `Total interventions: ${interventionsData[context.dataIndex]}`,
                                    `Average visits per vehicle: ${avgVisits}`
                                ];
                            }
                        }
                    }
                },
                interaction: {
                    intersect: false,
                    mode: 'point'
                },
                hover: {
                    animationDuration: 300
                }
            }
        });

        // Populate vehicles table
        function populateVehiclesTable() {
            const tbody = document.getElementById('vehiclesTableBody');
            tbody.innerHTML = '';
            
            topVehiclesData.forEach((vehicle, index) => {
                const row = document.createElement('tr');
                
                let statusClass = 'normal';
                let statusText = 'Normal';
                
                if (vehicle.days >= 50) {
                    statusClass = 'critical';
                    statusText = 'Critical';
                } else if (vehicle.days >= 30) {
                    statusClass = 'warning';
                    statusText = 'Attention';
                }
                
                row.innerHTML = `
                    <td><span class="rank">${index + 1}º</span></td>
                    <td><strong>${vehicle.plate}</strong></td>
                    <td>${vehicle.model}</td>
                    <td>${vehicle.visits}</td>
                    <td class="${statusClass}">${vehicle.days} days</td>
                    <td>${vehicle.avgDays} days</td>
                    <td><strong>${vehicle.odometer.toLocaleString()} km</strong></td>
                    <td>${vehicle.lastVisit}</td>
                    <td class="${statusClass}">${statusText}</td>
                `;
                
                tbody.appendChild(row);
            });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            populateVehiclesTable();
        });
    </script>
</body>
</html>
